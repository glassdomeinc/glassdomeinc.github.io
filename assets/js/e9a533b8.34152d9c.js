"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[4215],{4137:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,f=m["".concat(s,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(f,l(l({ref:t},c),{},{components:n})):r.createElement(f,l({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2504:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var r=n(7462),a=(n(7294),n(4137));const o={slug:"lo-example",title:"An example of mapping with lo library in Go",authors:"adil",tags:["lo","lodash","postgres","query","formatting","mapping","go"]},l=void 0,i={permalink:"/blog/lo-example",source:"@site/blog/2022-11-14-mapping-with-lo.md",title:"An example of mapping with lo library in Go",description:"What's lo and why?",date:"2022-11-14T00:00:00.000Z",formattedDate:"2022\ub144 11\uc6d4 14\uc77c",tags:[{label:"lo",permalink:"/blog/tags/lo"},{label:"lodash",permalink:"/blog/tags/lodash"},{label:"postgres",permalink:"/blog/tags/postgres"},{label:"query",permalink:"/blog/tags/query"},{label:"formatting",permalink:"/blog/tags/formatting"},{label:"mapping",permalink:"/blog/tags/mapping"},{label:"go",permalink:"/blog/tags/go"}],readingTime:1.695,hasTruncateMarker:!0,authors:[{name:"Adil",title:"Software Engineer",url:"https://github.com/adilb99",imageURL:"https://avatars.githubusercontent.com/u/47117931?v=4",key:"adil"}],frontMatter:{slug:"lo-example",title:"An example of mapping with lo library in Go",authors:"adil",tags:["lo","lodash","postgres","query","formatting","mapping","go"]},nextItem:{title:"Deploying an S3 static website with CDK for Terraform on Cloudfront vs Cloudflare",permalink:"/blog/cdktf-cloudfront-cloudflare"}},s={authorsImageUrls:[void 0]},p=[{value:"What&#39;s lo and why?",id:"whats-lo-and-why",level:2},{value:"Example mapping",id:"example-mapping",level:2},{value:"Other benefits of lo",id:"other-benefits-of-lo",level:2}],c={toc:p};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"whats-lo-and-why"},"What's lo and why?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/samber/lo"},"samber/lo")," is a Lodash-style library for Go that provides common methods for development such as Map, Filter, FlatMap, Reduce, Uniq and so on. (You can deduce what each method does by its name)"),(0,a.kt)("p",null,"Since the library functionality is so generic, it can be used in a variety of ways. In this particular example, I can show you that it can be helpful for processing DB data of unknown data type and putting it into type-safe structs."),(0,a.kt)("h2",{id:"example-mapping"},"Example mapping"),(0,a.kt)("p",null,"So, let's say we're getting data from Postgres, but certain values can be of different data type. You can consume the response into a generic Record struct as such:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'type Record struct {\n    Ts       time.Time\n    Id       string\n    Value    interface{}\n}\n\nnumericExample := Record{\n  Ts: time.Now(),\n  Id: "abc",\n  Value: 24.2\n}\n\nstringExample := Record{\n  Ts: time.Now(),\n  Id: "def",\n  Value: "SomeRandomValueeee"\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"*","Note: Let's also imagine the response is an array of such Records")),(0,a.kt)("p",null,"However, the Value can be either Boolean, Numeric or String. And we need to put the data into a response array that is as such:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type ResultItem struct {\n    Ts       time.Time\n    Id       string\n    BooleanValue    bool\n  StringValue     string\n  NumericValue    float64\n}\n\ntype ResultArray []ResultItem\n")),(0,a.kt)("p",null,"We can then use lo to map into a desired response array as such:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"items := lo.Map(records, func(record Record, _ int) ResultItem {\n  switch(record.Value.(type)) {\n    case float64:\n      return ResultItem{\n        Ts:           record.Ts,\n        NumericValue: record.Value,\n      }\n    case boolean:\n      return Result{\n        Ts:           record.Ts,\n        BooleanValue: record.Value,\n      }\n    default:\n      return ResultItem{\n        Ts:           record.Ts,\n        StringValue:  record.Value,\n      }\n  }\n})\n")),(0,a.kt)("p",null,"That way we can quickly and conveniently map the DB response into a struct we need the output to be in."),(0,a.kt)("h2",{id:"other-benefits-of-lo"},"Other benefits of lo"),(0,a.kt)("p",null,'Apart from mapping, this library offers abstractions for multitude of different generic operations, some of which may already be present in Go and some taken care of by "reflect" package. However, lo adds more generics and is generally shown to be faster based on performance benchmarks. So, there you have it.'),(0,a.kt)("p",null,"Happy coding! ~"))}u.isMDXComponent=!0}}]);